{
	'envelope':
	{
		'payload_sha512':
	'3bf1683d7120a2e4482919ddefaeaa1db20ce4013c563e2f1d7f96ebde186dde80a7abe231458a7fd587d884585692a42e31f5b99932dfe90922e3fdca830a54'
	},


	{
		'stamps':
		[
			{
				'class': 'author',
				'pubkey': '----BEGIN PUBLIC----\ndafhsdgsgzfshfshdfshsfhfad',
				'signature': 'sdt634652364123523423423423',
				'time_added' : 1304318238
			}
		]
		[
			{
				'class': 'origin',
				'pubkey': '----BEGIN PUBLIC----\ndafhsdgsgzfshfshdfshsfhfad',
				'signature': 'sdt634652364123523423423423',
				'time_added' : 1304318238
			}
		]
		[
			{
				'class': 'server',
				'hostname': 'pluric.com',
				'pubkey': '----BEGIN PUBLIC----\ndafhsdgsgzfshfshdfshsfhfad',
				'signature': 'sdt634652364123523423423423',
				'time_added' : 1304318238
			}
		]
	},

	{
		'payload':
		{
			'formatting':'markdown',
			'class':'message',
			'topictag':
			[
				'Startrek',
				'TV Shows'
			],		
			'to': '----BEGIN PUBLIC----\ndafhsdgsgzfshfshdfshsfhfad',
			'regarding': 'fa200fc2bbb11cfb2349668826685b5ec481d3555895877b5dd60d9981f411c665b2867023c61838cb78caf020ec61517aa3880ee225784fce6c560ecafeafaa',
			'coords': '29.199505,-90.041242',
			'author':
				{
					'pubkey': '----BEGIN PUBLIC----\ndafhsdgsgzfshfshdfshsfhfad',
					'friendlyname': 'E1ven',
					'about': '0cb128a753dec8d8d56eedc41e43083d02ec365407ca827fac7b18745eefa282ab6df1c8b97ddaed8b57ba87225bc6a0096c03effd71f8c68aea87db9fea4a43',
					'useragent': 'Pluric for Android 1.0'
				},
				'subject': 'Need more Startrek',
				'body': 'When are they going to create a *new* series? I think the movies have re...',
				binaries:
					[
						{	
						'sha_512' : 'c3132d34d5fcebd73b096c3e40e78b803040283d457b4d486c46ea8eade0d7ea8b4b5840273f123d2c45c52fa76d87c476d66dbcc93808d7561db1ead80c5d1b',
						'filesize_hint' : 96375,
						'content_type' : 'image/png',
						'filename' : 'Screen Shot 2011-06-30 at 8.03.57 AM.png'
						}
					]
	},
	
	{
		'local':
		{
			'cited_by':
			[
			'12sfhsdzhjdzfjhdxgj4'
			]
		}
}

---



The "time_seen" format is the number of seconds since the epoch, expressed in UTC.

The 'MESSAGE_SHA512' should be the SHA-512 hash of the 'Message' portion. This is included to give each message a unique MessageID, so it can be referenced, stored, etc.
SHA1 or 256 likely would have been sufficient, but 512 decreases collision chance. 


The SERVER_STAMP section allows an authority to sign the "message" portion of the message, to verify that some criteria has been satisfied. 
Exactly what criteria this is depends on the Authority- Examples might be 'completed a captcha', or 'Authenticated with a FB username/password'



The 'sender_signature' should be a RSA signature of the 'Message' portion. This is the initial signature on any message. The sender_signature uses a SHA512 hash of the message.

The server's signature should also be of the "Message" portion, not the entire container.

"Regarding" should be the 'POSTID_SHA512' of the message, if any, that this is in reference to.  If this is not in reference to another message, this field should be omitted.
You should not post a message with a "regarding" of a binary-control-message. If you do, a server should discard the message.




The "TopicTag" field may be used to specify the overall topic. This can be thought of akin to a HashTag in twitter, a Subreddit on Reddit, or a Newsgroup on Usenet.  
You may specify any number of topics you wish, but many servers will not carry a message if it has too many. (Pluric.com limits you to 3)
You may also omit any topictags entirely. In this case, only people following you are likely to see the message.

The optional "TO" field allows you to specify a public key of a person to whom the message is directed. Their client may or may not look for this field.
You may specify any number of "TO" fields, but many servers will not carry a message if it has too many. (Pluric.com limits you to 100)
You may omit a "TO" tag- Most messages shouldn't carry one!


The "Author" fields are included to positively tie a message with an author. This is included inside of the 'Message' block so that it is signed, along with the rest of the message.
The 'from' field should contain the RSA public key of the author. This is used as the author's primary identity. A client might include a "Follow User" button using this.
The optional 'About' field may contain a POSTID-SHA512 linking to the author's most-recent about-me Post.
The 'friendlyname' is a friendly-short name, that is not necessarily unique across services. We don't call it a username, since that implies uniqueness.


The client string is intentionally free-form- While it would be tempting to use a client signature here to 'prove' what client it is, it is ultimately untrustworthy.
Many/Most clients would be distributed to end-users (iPhone/Android/Etc). Even if the source were obscured the private signing key would need to be included, and could be extracted.
Since this is impossible to secure, it's best to treat this like a web browser's USER-AGENT. Interesting to know, but Entirely untrusted.
If you *really* want to sign a message, include a 'STAMP' signature by the server, or, if you really, really, really want to, the client.


The "Subject" should contain the subject of the message. If you are replying to an existing message, it's fine to import from that message. DO NOT change the subject to add a "RE: "-whatever. Just set the "regarding" field.
The "Body" section should be plaintext. Github-flavored markdown could be a potential option, but there aren't parsing libraries for every platform, and linebreaks/etc are overkill for simple message exchange.


Any binaries that are to be included should have a the SHA512 of their uploaded file.

The 'Message' section may alternatively be replaced by 'ENCRYPTED_MESSAGE'.


<ENCRYPTED_MESSAGE>
	<TO>PUBLICKEY_ABCDEFG</TO>
	<ENC_DATA>28eab1ff5e9f0ad6d298a2fa4b510f5454abbdb17c3a225784fce6c560e....</ENC_DATA>
</ENCRYPTED_MESSAGE>

The "To" field is optional, and allows clients to quickly discard a message if they know it is not one they can read.
The "ENC_DATA" text should be identical to the "MESSAGE" text above, including formatting, after decryption by the proper private-key.
In this case, the "POSTID-SHA512" field, should contain the SHA-512 of the "ENCRYPTED_MESSAGE" field.


http://www.thomasfrank.se/xml_to_json.html
